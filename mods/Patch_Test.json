{
  "name": "Patch_Test",
  "author": "Cobalt Official",
  "description": "Adds a Patch_Test tab with a CMLM code editor and file drop loader.",
  "code": "(function () {\n  if (document.querySelector('[data-tab=\"patch_test\"]')) return;\n\n  // Create tab button\n  const tabButton = document.createElement('div');\n  tabButton.className = 'cobalt-tab';\n  tabButton.dataset.tab = 'patch_test';\n  tabButton.textContent = 'Patch_Test';\n  document.getElementById('cobalt-tabs').appendChild(tabButton);\n\n  // Create tab content panel\n  const tabContent = document.createElement('div');\n  tabContent.id = 'patch_test';\n  tabContent.className = 'cobalt-tab-content';\n  tabContent.innerHTML = `\n    <h2>Patch_Test</h2>\n    <p>Write your Cobalt MOD code below and save it as a .CMLM file.</p>\n    <textarea id=\"cmlm-editor\" style=\"width:100%;height:200px;font-family:monospace;\"></textarea>\n    <br>\n    <button id=\"cmlm-save\">Save as .CMLM</button>\n    <div id=\"cmlm-dropzone\" style=\"margin-top:20px;padding:20px;border:2px dashed #888;text-align:center;\">\n      Drop .CMLM file here to load\n    </div>\n  `;\n  document.getElementById('cobalt-sidebar').appendChild(tabContent);\n\n  // Tab switching logic\n  tabButton.addEventListener('click', () => {\n    document.querySelectorAll('.cobalt-tab').forEach(t => t.classList.remove('active'));\n    document.querySelectorAll('.cobalt-tab-content').forEach(c => c.classList.remove('active'));\n    tabButton.classList.add('active');\n    tabContent.classList.add('active');\n  });\n\n  // Save button logic\n  document.getElementById('cmlm-save').addEventListener('click', () => {\n    const code = document.getElementById('cmlm-editor').value;\n    const blob = new Blob([code], { type: 'text/plain' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = 'mod.cmlm';\n    a.click();\n    URL.revokeObjectURL(a.href);\n  });\n\n  // Drop zone logic\n  const dropzone = document.getElementById('cmlm-dropzone');\n  dropzone.addEventListener('dragover', e => e.preventDefault());\n  dropzone.addEventListener('drop', e => {\n    e.preventDefault();\n    const file = e.dataTransfer.files[0];\n    if (file && file.name.endsWith('.cmlm')) {\n      const reader = new FileReader();\n      reader.onload = () => {\n        document.getElementById('cmlm-editor').value = reader.result;\n      };\n      reader.readAsText(file);\n    } else {\n      alert('Please drop a .CMLM file');\n    }\n  });\n\n  // Cleanup function\n  window.Patch_Test_stop = function () {\n    tabButton.remove();\n    tabContent.remove();\n  };\n})();"
}
