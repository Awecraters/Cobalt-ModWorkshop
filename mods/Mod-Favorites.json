{
  "name": "Mod Favorites",
  "author": "Cobalt Official",
  "description": "Lets users star mods and view a Favorites tab in the Workshop and Mods tab.",
  "code": "(function () {\n  const STORAGE_KEY = 'cobaltFavorites';\n\n  function getFavorites() {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    return stored ? JSON.parse(stored) : [];\n  }\n\n  function saveFavorites(favs) {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(favs));\n  }\n\n  function toggleFavorite(modName) {\n    const favs = getFavorites();\n    const index = favs.indexOf(modName);\n    if (index >= 0) {\n      favs.splice(index, 1);\n    } else {\n      favs.push(modName);\n    }\n    saveFavorites(favs);\n    updateStars();\n  }\n\n  function injectStar(card, modName) {\n    const nameEl = card.querySelector('strong');\n    if (!nameEl || card.querySelector('.mod-fav-star')) return;\n\n    const star = document.createElement('span');\n    star.className = 'mod-fav-star';\n    star.textContent = 'â­';\n    star.style.cursor = 'pointer';\n    star.style.marginLeft = '8px';\n    star.title = 'Favorite this mod';\n    star.addEventListener('click', e => {\n      e.stopPropagation();\n      toggleFavorite(modName);\n    });\n    nameEl.appendChild(star);\n  }\n\n  function updateStars() {\n    const favs = getFavorites();\n    document.querySelectorAll('.mod-card').forEach(card => {\n      const nameEl = card.querySelector('strong');\n      const modName = nameEl?.textContent.trim();\n      if (!modName) return;\n      injectStar(card, modName);\n      const star = card.querySelector('.mod-fav-star');\n      if (star) star.style.opacity = favs.includes(modName) ? '1' : '0.3';\n    });\n  }\n\n  function createFavoritesTab() {\n    const tabBar = document.getElementById('cobalt-tabs');\n    if (!tabBar || document.getElementById('favorites-tab')) return;\n\n    const favTab = document.createElement('div');\n    favTab.textContent = 'Favorites';\n    favTab.className = 'cobalt-tab';\n    favTab.id = 'favorites-tab';\n    favTab.dataset.tab = 'favorites';\n    tabBar.appendChild(favTab);\n\n    const favContent = document.createElement('div');\n    favContent.id = 'favorites';\n    favContent.className = 'cobalt-tab-content';\n    document.getElementById('cobalt-sidebar').appendChild(favContent);\n\n    favTab.addEventListener('click', () => {\n      document.querySelectorAll('.cobalt-tab').forEach(t => t.classList.remove('active'));\n      document.querySelectorAll('.cobalt-tab-content').forEach(c => c.classList.remove('active'));\n      favTab.classList.add('active');\n      favContent.classList.add('active');\n\n      const favs = getFavorites();\n      favContent.innerHTML = '';\n      document.querySelectorAll('.mod-card').forEach(card => {\n        const modName = card.querySelector('strong')?.textContent.trim();\n        if (favs.includes(modName)) {\n          const clone = card.cloneNode(true);\n          injectStar(clone, modName);\n          favContent.appendChild(clone);\n        }\n      });\n    });\n  }\n\n  function injectStyles() {\n    const style = document.createElement('style');\n    style.textContent = `\n      .mod-fav-star {\n        font-size: 1.2em;\n        margin-left: 6px;\n        transition: opacity 0.2s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  function hookIntoModLoader() {\n    if (!window.CobaltHash || typeof CobaltHash.renderMods !== 'function') return;\n    const originalRender = CobaltHash.renderMods;\n    CobaltHash.renderMods = function () {\n      originalRender.call(this);\n      updateStars();\n    };\n  }\n\n  function observeWorkshop() {\n    const workshop = document.getElementById('workshop');\n    if (!workshop) return;\n    const observer = new MutationObserver(() => updateStars());\n    observer.observe(workshop, { childList: true, subtree: true });\n  }\n\n  function init() {\n    injectStyles();\n    createFavoritesTab();\n    hookIntoModLoader();\n    observeWorkshop();\n    updateStars();\n  }\n\n  const wait = setInterval(() => {\n    if (document.getElementById('cobalt-tabs') && document.getElementById('cobalt-sidebar')) {\n      clearInterval(wait);\n      init();\n    }\n  }, 500);\n})();"
}
